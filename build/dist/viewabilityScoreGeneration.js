(self.pbjsChunk=self.pbjsChunk||[]).push([[663],{5605:function(e,t,i){var a=i(4942),o=i(3193),n=i(9528),d=i(2021),r=i(5644);function l(e,t){var i;localStorage.getItem("viewability-data")&&(i=JSON.parse(localStorage.getItem("viewability-data")),t.forEach((function(e){e.bids.forEach((function(e){i[e.adUnitCode]&&(e.bidViewability=i[e.adUnitCode])}))}))),e(t)}d.on(r.FP.AUCTION_INIT,(function(){if(!0===(o.vc.getConfig("viewabilityScoreGeneration")||{}).enabled){var e=JSON.parse(localStorage.getItem("viewability-data"));window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((function(){window.googletag.pubads().addEventListener("slotRenderEnded",(function(t){var i=t.slot.getSlotElementId();e?e[i]?(e[i].lastViewed&&delete e[i].lastViewed,e[i].rendered=e[i].rendered+1,e[i].updatedAt=Date.now().toString()):e[i]={rendered:1,viewed:0,createdAt:Date.now().toString()}:e=(0,a.Z)({},i,{rendered:1,viewed:0,createdAt:Date.now().toString()}),localStorage.setItem("viewability-data",JSON.stringify(e))})),window.googletag.pubads().addEventListener("impressionViewable",(function(t){var i=t.slot.getSlotElementId();e?e[i]?(e[i].viewed=e[i].viewed+1,e[i].updatedAt=Date.now().toString()):e[i]={rendered:0,viewed:1,createdAt:Date.now().toString()}:e=(0,a.Z)({},i,{rendered:0,viewed:1,createdAt:Date.now().toString()}),localStorage.setItem("viewability-data",JSON.stringify(e))})),window.googletag.pubads().addEventListener("slotVisibilityChanged",(function(t){if(t.inViewPercentage>50){var i=t.slot.getSlotElementId(),a=e[i].lastViewed,o=performance.now();if(a){var n=o-a;e[i].totalViewTime=(e[i].totalViewTime||0)+n}e[i].lastViewed=o,localStorage.setItem("viewability-data",JSON.stringify(e))}}))}))}})),n.ZP.makeBidRequests.after(l),window.pbjs.installedModules.push("viewabilityScoreGeneration")}},function(e){var t;t=5605,e(e.s=t)}]);