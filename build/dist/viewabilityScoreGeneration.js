(self.pbjsChunk=self.pbjsChunk||[]).push([[663],{5605:function(e,t,i){var a=i(4942),d=i(3193),n=i(9528),o=i(2021),l=i(5644);function r(e,t){var i;localStorage.getItem("viewability-data")&&(i=JSON.parse(localStorage.getItem("viewability-data")),t.forEach((function(e){e.bids.forEach((function(e){i[e.adUnitCode]&&(e.bidViewability=i[e.adUnitCode])}))}))),e(t)}o.on(l.FP.AUCTION_INIT,(function(){if(!0===(d.vc.getConfig("viewabilityScoreGeneration")||{}).enabled){var e=JSON.parse(localStorage.getItem("viewability-data"));window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((function(){window.googletag.pubads().addEventListener("slotRenderEnded",(function(t){var i=t.slot.getSlotElementId();e?e[i]?(e[i].lastViewed&&delete e[i].lastViewed,e[i].rendered=e[i].rendered+1,e[i].updatedAt=new Date):e[i]={rendered:1,viewed:0,createdAt:new Date}:e=(0,a.Z)({},i,{rendered:1,viewed:0,createdAt:new Date}),localStorage.setItem("viewability-data",JSON.stringify(e))})),window.googletag.pubads().addEventListener("impressionViewable",(function(t){var i=t.slot.getSlotElementId();e?e[i]?(e[i].viewed=e[i].viewed+1,e[i].updatedAt=new Date):e[i]={rendered:0,viewed:1,createdAt:new Date}:e=(0,a.Z)({},i,{rendered:0,viewed:1,createdAt:new Date}),localStorage.setItem("viewability-data",JSON.stringify(e))})),window.googletag.pubads().addEventListener("slotVisibilityChanged",(function(t){if(t.inViewPercentage>50){var i=t.slot.getSlotElementId(),a=e[i].lastViewed,d=performance.now();if(a){var n=d-a;e[i].totalViewTime=(e[i].totalViewTime||0)+n}e[i].lastViewed=d,localStorage.setItem("viewability-data",JSON.stringify(e))}}))}))}})),n.ZP.makeBidRequests.after(r),window.pbjs.installedModules.push("viewabilityScoreGeneration")}},function(e){var t;t=5605,e(e.s=t)}]);